{
  "name": "üîß Sub-Workflow Webhook Modifikationen (Referenz-Template)",
  "nodes": [
    {
      "id": "info-note",
      "name": "üìã ANLEITUNG",
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [-200, -600],
      "parameters": {
        "content": "# üîß Sub-Workflow Webhook Modifikationen\n\nDieses Template enth√§lt die **Webhook Trigger + Respond to Webhook** Node-Paare,\ndie du in deine 5 bestehenden Sub-Workflows einf√ºgen musst.\n\n## Anleitung pro Sub-Workflow:\n1. √ñffne den bestehenden Sub-Workflow in n8n\n2. Kopiere das passende **Webhook Trigger + Respond to Webhook** Paar aus diesem Template\n3. Verbinde den Webhook Trigger mit dem ersten Verarbeitungsnode\n4. Verbinde den letzten Datennode mit dem Respond to Webhook Node\n5. Die bestehende Schedule-Trigger ‚Üí Email Logik bleibt unber√ºhrt\n\n## F√ºr die 2 On-Demand Workflows (AI Visibility + Comment Intelligence):\nKein Webhook n√∂tig ‚Äì der Abteilungsleiter Agent liest direkt aus Google Sheets.\nStelle sicher, dass diese Workflows ihre Ergebnisse in ein Google Sheet schreiben.\n\n## Umgebungsvariablen (in n8n Settings setzen):\n- WEBHOOK_SEO_DASHBOARD\n- WEBHOOK_FUNNEL_REPORT\n- WEBHOOK_CLARITY_REPORT\n- WEBHOOK_KEYWORD_TRACKER\n- WEBHOOK_LINKEDIN_MONITOR\n- SHEET_AI_VISIBILITY (Google Sheet ID)\n- SHEET_COMMENT_INTELLIGENCE (Google Sheet ID)\n- SHEET_WEEKLY_SNAPSHOTS (Google Sheet ID)\n- REPORT_RECIPIENT (z.B. mark@mo-casa.com)",
        "width": 520,
        "height": 580,
        "color": 4
      }
    },
    {
      "parameters": {
        "content": "# 1Ô∏è‚É£ SEO/GEO Dashboard\nWorkflow-ID: zIvvqg9P2eTQfl6y\n\n**Webhook Trigger** ‚Üí verbinde mit deinem ersten Verarbeitungsnode (z.B. \"Calculate Date Range\")\n**Respond to Agent** ‚Üí verbinde nach \"üì¶ Combine All Reports\"",
        "width": 460,
        "height": 120,
        "color": 1
      },
      "id": "note-seo",
      "name": "üìù SEO Info",
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [40, -400]
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "agent-seo-dashboard",
        "responseMode": "responseNode",
        "options": {}
      },
      "id": "webhook-seo",
      "name": "üåê Webhook: SEO Dashboard",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [80, -240],
      "webhookId": "agent-seo-dashboard",
      "notes": "POST /webhook/agent-seo-dashboard\nKopiere diesen Node in den SEO/GEO Dashboard Workflow.\nVerbinde Output ‚Üí erster Verarbeitungsnode (z.B. Calculate Date Range)"
    },
    {
      "parameters": {
        "jsCode": "// ========================================\n// SEO DASHBOARD: Daten f√ºr Agent aufbereiten\n// ========================================\n// Dieser Code Node sammelt die Ergebnisse aus dem SEO Dashboard Workflow\n// und gibt sie im erwarteten JSON-Format zur√ºck.\n//\n// ANPASSUNG N√ñTIG: Ersetze die Node-Referenzen mit den tats√§chlichen\n// Node-Namen aus deinem SEO Dashboard Workflow.\n// ========================================\n\n// Beispiel: Daten aus vorherigen Nodes holen\n// const gscData = $('GSC Search Analytics').first().json;\n// const ga4Data = $('GA4 Report').first().json;\n// const clarityData = $('Clarity Data').first().json;\n\nconst now = new Date();\n\nreturn {\n  json: {\n    source: 'seo_geo_dashboard',\n    timestamp: now.toISOString(),\n    dateRange: $input.first().json.dateRange || 'nicht angegeben',\n    gsc: {\n      totalClicks: 0,       // ‚Üê Ersetzen mit echten Daten\n      totalImpressions: 0,  // ‚Üê Ersetzen mit echten Daten\n      totalCtr: 0,\n      avgPosition: 0,\n      topQueries: [],\n      geoPerformance: []\n    },\n    ga4: {\n      organicSessions: 0,\n      organicUsers: 0,\n      avgEngagementRate: 0,\n      avgSessionDuration: 0,\n      conversions: 0,\n      topLandingPages: []\n    },\n    clarity: {\n      totalSessions: 0,\n      deadClickRate: 0,\n      rageClickRate: 0,\n      scrollDepthAvg: 0,\n      topPages: []\n    }\n  }\n};"
      },
      "id": "transform-seo",
      "name": "üì¶ SEO Daten aufbereiten",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [300, -240],
      "notes": "ANPASSEN: Ersetze Platzhalter mit echten Node-Referenzen aus deinem SEO Workflow"
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={{ JSON.stringify($json) }}",
        "options": {
          "responseCode": 200,
          "responseHeaders": {
            "entries": [
              { "name": "Content-Type", "value": "application/json" }
            ]
          }
        }
      },
      "id": "respond-seo",
      "name": "üì§ Respond: SEO Dashboard",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [520, -240],
      "notes": "Gibt SEO-Daten als JSON an den Abteilungsleiter Agent zur√ºck"
    },
    {
      "parameters": {
        "content": "# 2Ô∏è‚É£ Funnel & Conversion\nWorkflow-ID: yZG8V-xqjigWY3cXZXDdN\n\n**Webhook Trigger** ‚Üí verbinde mit \"Calculate Date Range\"\n**Respond to Agent** ‚Üí verbinde nach \"Calculate KPIs & Generate Report\"",
        "width": 460,
        "height": 120,
        "color": 2
      },
      "id": "note-funnel",
      "name": "üìù Funnel Info",
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [40, -60]
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "agent-funnel-report",
        "responseMode": "responseNode",
        "options": {}
      },
      "id": "webhook-funnel",
      "name": "üåê Webhook: Funnel Report",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [80, 100],
      "webhookId": "agent-funnel-report",
      "notes": "POST /webhook/agent-funnel-report\nKopiere in den Funnel & Conversion Workflow.\nVerbinde Output ‚Üí Calculate Date Range"
    },
    {
      "parameters": {
        "jsCode": "// ========================================\n// FUNNEL REPORT: Daten f√ºr Agent aufbereiten\n// ========================================\n// ANPASSUNG N√ñTIG: Ersetze Node-Referenzen\n// ========================================\n\nconst now = new Date();\n\nreturn {\n  json: {\n    source: 'funnel_conversion',\n    timestamp: now.toISOString(),\n    dateRange: $input.first().json.dateRange || 'nicht angegeben',\n    gscMetrics: {\n      totalClicks: 0,\n      totalImpressions: 0,\n      totalCtr: 0,\n      byDevice: {\n        MOBILE: { clicks: 0, impressions: 0, ctr: 0 },\n        DESKTOP: { clicks: 0, impressions: 0, ctr: 0 }\n      }\n    },\n    ga4Funnel: {\n      sessions: 0,\n      engagedSessions: 0,\n      conversions: 0,\n      conversionRate: 0,\n      revenue: 0,\n      topConversionPages: []\n    }\n  }\n};"
      },
      "id": "transform-funnel",
      "name": "üì¶ Funnel Daten aufbereiten",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [300, 100],
      "notes": "ANPASSEN: Ersetze Platzhalter mit echten Node-Referenzen aus deinem Funnel Workflow"
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={{ JSON.stringify($json) }}",
        "options": {
          "responseCode": 200,
          "responseHeaders": {
            "entries": [
              { "name": "Content-Type", "value": "application/json" }
            ]
          }
        }
      },
      "id": "respond-funnel",
      "name": "üì§ Respond: Funnel Report",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [520, 100],
      "notes": "Gibt Funnel-Daten als JSON an den Abteilungsleiter Agent zur√ºck"
    },
    {
      "parameters": {
        "content": "# 3Ô∏è‚É£ Microsoft Clarity\nWorkflow-ID: SrLCQBDR8gutY2Ri\n\n**Webhook Trigger** ‚Üí verbinde mit dem ersten Clarity API Call\n**Respond to Agent** ‚Üí verbinde nach \"Merge All Data\"",
        "width": 460,
        "height": 120,
        "color": 3
      },
      "id": "note-clarity",
      "name": "üìù Clarity Info",
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [40, 280]
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "agent-clarity-report",
        "responseMode": "responseNode",
        "options": {}
      },
      "id": "webhook-clarity",
      "name": "üåê Webhook: Clarity Report",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [80, 440],
      "webhookId": "agent-clarity-report",
      "notes": "POST /webhook/agent-clarity-report\nKopiere in den Clarity Workflow.\nVerbinde Output ‚Üí Fetch Clarity Data"
    },
    {
      "parameters": {
        "jsCode": "// ========================================\n// CLARITY REPORT: Daten f√ºr Agent aufbereiten\n// ========================================\n// ANPASSUNG N√ñTIG: Ersetze Node-Referenzen\n// ========================================\n\nconst now = new Date();\n\nreturn {\n  json: {\n    source: 'clarity_report',\n    timestamp: now.toISOString(),\n    totalSessions: 0,\n    deadClickRate: 0,\n    rageClickRate: 0,\n    scrollDepth: { '25': 0, '50': 0, '75': 0, '100': 0 },\n    returningSessions: 0,\n    returningRate: 0,\n    avgActiveTime: 0,\n    topPages: [],\n    topReferrers: []\n  }\n};"
      },
      "id": "transform-clarity",
      "name": "üì¶ Clarity Daten aufbereiten",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [300, 440],
      "notes": "ANPASSEN: Ersetze Platzhalter mit echten Node-Referenzen aus deinem Clarity Workflow"
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={{ JSON.stringify($json) }}",
        "options": {
          "responseCode": 200,
          "responseHeaders": {
            "entries": [
              { "name": "Content-Type", "value": "application/json" }
            ]
          }
        }
      },
      "id": "respond-clarity",
      "name": "üì§ Respond: Clarity Report",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [520, 440],
      "notes": "Gibt Clarity-Daten als JSON an den Abteilungsleiter Agent zur√ºck"
    },
    {
      "parameters": {
        "content": "# 4Ô∏è‚É£ Keyword Ranking Tracker\nWorkflow-ID: O4Mh77CwNnBFBPDg\n\n**Webhook Trigger** ‚Üí verbinde mit \"Load Keyword List\"\n**Respond to Agent** ‚Üí verbinde nach dem letzten Ranking-Check-Node",
        "width": 460,
        "height": 120,
        "color": 5
      },
      "id": "note-keywords",
      "name": "üìù Keywords Info",
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [40, 620]
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "agent-keyword-tracker",
        "responseMode": "responseNode",
        "options": {}
      },
      "id": "webhook-keywords",
      "name": "üåê Webhook: Keyword Tracker",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [80, 780],
      "webhookId": "agent-keyword-tracker",
      "notes": "POST /webhook/agent-keyword-tracker\nKopiere in den Keyword Ranking Workflow.\nVerbinde Output ‚Üí Load Keyword List"
    },
    {
      "parameters": {
        "jsCode": "// ========================================\n// KEYWORD TRACKER: Daten f√ºr Agent aufbereiten\n// ========================================\n// ANPASSUNG N√ñTIG: Ersetze Node-Referenzen\n// ========================================\n\nconst now = new Date();\n\nreturn {\n  json: {\n    source: 'keyword_tracker',\n    timestamp: now.toISOString(),\n    totalKeywords: 0,\n    rankings: [],\n    summary: {\n      improved: 0,\n      declined: 0,\n      stable: 0,\n      notRanking: 0,\n      avgPosition: 0,\n      avgPositionPrev: 0\n    }\n  }\n};"
      },
      "id": "transform-keywords",
      "name": "üì¶ Keyword Daten aufbereiten",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [300, 780],
      "notes": "ANPASSEN: Ersetze Platzhalter mit echten Node-Referenzen aus deinem Keyword Workflow"
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={{ JSON.stringify($json) }}",
        "options": {
          "responseCode": 200,
          "responseHeaders": {
            "entries": [
              { "name": "Content-Type", "value": "application/json" }
            ]
          }
        }
      },
      "id": "respond-keywords",
      "name": "üì§ Respond: Keyword Tracker",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [520, 780],
      "notes": "Gibt Keyword-Ranking-Daten als JSON an den Abteilungsleiter Agent zur√ºck"
    },
    {
      "parameters": {
        "content": "# 5Ô∏è‚É£ LinkedIn Message Monitoring\nWorkflow-ID: tDairVFjYFw7cjJD8nfct\n\n**Webhook Trigger** ‚Üí verbinde mit \"Get Unipile Accounts\"\n**Respond to Agent** ‚Üí verbinde nach \"Analyze Unanswered\"",
        "width": 460,
        "height": 120,
        "color": 6
      },
      "id": "note-linkedin",
      "name": "üìù LinkedIn Info",
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [40, 960]
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "agent-linkedin-monitor",
        "responseMode": "responseNode",
        "options": {}
      },
      "id": "webhook-linkedin",
      "name": "üåê Webhook: LinkedIn Monitor",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [80, 1120],
      "webhookId": "agent-linkedin-monitor",
      "notes": "POST /webhook/agent-linkedin-monitor\nKopiere in den LinkedIn Monitoring Workflow.\nVerbinde Output ‚Üí Get Unipile Accounts"
    },
    {
      "parameters": {
        "jsCode": "// ========================================\n// LINKEDIN MONITOR: Daten f√ºr Agent aufbereiten\n// ========================================\n// ANPASSUNG N√ñTIG: Ersetze Node-Referenzen\n// ========================================\n\nconst now = new Date();\n\nreturn {\n  json: {\n    source: 'linkedin_monitor',\n    timestamp: now.toISOString(),\n    totalScanned: 0,\n    totalUnanswered: 0,\n    unansweredChats: []\n  }\n};"
      },
      "id": "transform-linkedin",
      "name": "üì¶ LinkedIn Daten aufbereiten",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [300, 1120],
      "notes": "ANPASSEN: Ersetze Platzhalter mit echten Node-Referenzen aus deinem LinkedIn Workflow"
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={{ JSON.stringify($json) }}",
        "options": {
          "responseCode": 200,
          "responseHeaders": {
            "entries": [
              { "name": "Content-Type", "value": "application/json" }
            ]
          }
        }
      },
      "id": "respond-linkedin",
      "name": "üì§ Respond: LinkedIn Monitor",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [520, 1120],
      "notes": "Gibt LinkedIn-Daten als JSON an den Abteilungsleiter Agent zur√ºck"
    },
    {
      "parameters": {
        "content": "# 6Ô∏è‚É£ + 7Ô∏è‚É£ On-Demand Workflows\n\n## AI Visibility Checker\n‚Üí Kein Webhook n√∂tig. Der Agent liest direkt aus Google Sheets.\n‚Üí Stelle sicher, dass der Workflow Ergebnisse in ein Sheet schreibt.\n‚Üí Ben√∂tigte Spalten: Timestamp, Queries, TopSources, TotalMentions, CompetitorMentions, RawData\n\n## Cross-Platform Comment Intelligence\n‚Üí Kein Webhook n√∂tig. Der Agent liest direkt aus Google Sheets.\n‚Üí Stelle sicher, dass der Workflow Ergebnisse in ein Sheet schreibt.\n‚Üí Ben√∂tigte Spalten: Timestamp, PlatformSummary, TopThemes, OverallSentiment, RawData\n\n## Google Sheet: Weekly Snapshots\n‚Üí Erstelle ein neues Google Sheet mit folgenden Spalten:\nKW | Jahr | Datum | DateLabel | ConsolidatedData | AIAnalysis | OverallStatus | AvailableSources",
        "width": 520,
        "height": 320,
        "color": 7
      },
      "id": "note-ondemand",
      "name": "üìù On-Demand & Sheets Info",
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [640, -400]
    },
    {
      "parameters": {
        "content": "# üîë Ben√∂tigte Credentials\n\n1. **OpenAI API** ‚Äì F√ºr GPT-4.1 AI-Analyse\n2. **Gmail OAuth2** ‚Äì F√ºr Email-Versand\n3. **Google Sheets OAuth2** ‚Äì F√ºr Snapshot-Speicherung\n\n# ‚ö° Umgebungsvariablen\n\nIn n8n Settings ‚Üí Environment Variables:\n```\nWEBHOOK_SEO_DASHBOARD=https://dein-n8n.com/webhook/agent-seo-dashboard\nWEBHOOK_FUNNEL_REPORT=https://dein-n8n.com/webhook/agent-funnel-report\nWEBHOOK_CLARITY_REPORT=https://dein-n8n.com/webhook/agent-clarity-report\nWEBHOOK_KEYWORD_TRACKER=https://dein-n8n.com/webhook/agent-keyword-tracker\nWEBHOOK_LINKEDIN_MONITOR=https://dein-n8n.com/webhook/agent-linkedin-monitor\nSHEET_AI_VISIBILITY=<Google Sheet ID>\nSHEET_COMMENT_INTELLIGENCE=<Google Sheet ID>\nSHEET_WEEKLY_SNAPSHOTS=<Google Sheet ID>\nREPORT_RECIPIENT=mark@mo-casa.com\n```",
        "width": 520,
        "height": 400,
        "color": 4
      },
      "id": "note-credentials",
      "name": "üìù Credentials & Env Vars",
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [640, 0]
    }
  ],
  "connections": {
    "üåê Webhook: SEO Dashboard": {
      "main": [
        [
          {
            "node": "üì¶ SEO Daten aufbereiten",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üì¶ SEO Daten aufbereiten": {
      "main": [
        [
          {
            "node": "üì§ Respond: SEO Dashboard",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üåê Webhook: Funnel Report": {
      "main": [
        [
          {
            "node": "üì¶ Funnel Daten aufbereiten",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üì¶ Funnel Daten aufbereiten": {
      "main": [
        [
          {
            "node": "üì§ Respond: Funnel Report",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üåê Webhook: Clarity Report": {
      "main": [
        [
          {
            "node": "üì¶ Clarity Daten aufbereiten",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üì¶ Clarity Daten aufbereiten": {
      "main": [
        [
          {
            "node": "üì§ Respond: Clarity Report",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üåê Webhook: Keyword Tracker": {
      "main": [
        [
          {
            "node": "üì¶ Keyword Daten aufbereiten",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üì¶ Keyword Daten aufbereiten": {
      "main": [
        [
          {
            "node": "üì§ Respond: Keyword Tracker",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üåê Webhook: LinkedIn Monitor": {
      "main": [
        [
          {
            "node": "üì¶ LinkedIn Daten aufbereiten",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "üì¶ LinkedIn Daten aufbereiten": {
      "main": [
        [
          {
            "node": "üì§ Respond: LinkedIn Monitor",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "pinData": {},
  "settings": {
    "executionOrder": "v1",
    "timezone": "Europe/Berlin",
    "saveManualExecutions": true,
    "callerPolicy": "workflowsFromSameOwner"
  },
  "staticData": null,
  "tags": [
    { "name": "Agent", "id": "agent-tag" },
    { "name": "Template", "id": "template-tag" },
    { "name": "Webhook", "id": "webhook-tag" }
  ],
  "triggerCount": 5,
  "versionId": "1",
  "meta": {
    "instanceId": "",
    "templateCredsSetupCompleted": false
  }
}